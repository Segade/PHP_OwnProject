            $session_name = 'sec_session_id'; //Configura un nombre de sesión personalizado
                            $secure = false; //Configura en verdadero (true) si utilizas https
                            $httponly = true; //Esto detiene que javascript sea capaz de accesar la identificación de la sesión.
                            ini_set('session.use_only_cookies', 1); //Forza a las sesiones a sólo utilizar cookies.
                            $cookieParams = session_get_cookie_params(); //Obtén params de cookies actuales.
                            session_set_cookie_params($cookieParams["lifetime"], $cookieParams["path"], $cookieParams["domain"], $secure, $httponly);
                            session_name($session_name); //Configura el nombre de sesión a el configurado arriba.
                            session_start(); //Inicia la sesión php
                            session_regenerate_id(true); //Regenera la sesión, borra la previa.
                    $user_browser = $_SERVER['HTTP_USER_AGENT']; //Obtén el agente de usuario del usuario
                    $_SESSION['form_string'] = hash('sha512', $user_browser);
                    $_SESSION['valida'] = "Validado";


//
            $session_name = 'sec_session_id'; //Configura un nombre de sesión personalizado
                            $secure = false; //Configura en verdadero (true) si utilizas https
                            $httponly = true; //Esto detiene que javascript sea capaz de accesar la identificación de la sesión.
                            ini_set('session.use_only_cookies', 1); //Forza a las sesiones a sólo utilizar cookies.
                            $cookieParams = session_get_cookie_params(); //Obtén params de cookies actuales.
                            session_set_cookie_params($cookieParams["lifetime"], $cookieParams["path"], $cookieParams["domain"], $secure, $httponly);
                            session_name($session_name); //Configura el nombre de sesión a el configurado arriba.
                            session_start(); //Inicia la sesión php
                            session_regenerate_id(true); //Regenera la sesión, borra la previa.
                    $user_browser = $_SERVER['HTTP_USER_AGENT']; //Obtén el agente de usuario del usuario

    if (!isset($_SESSION['valida'], $_SESSION['form_string']) || $_SESSION['form_string']!=$user_browser || $_SESSION['valida']!= "validado") {




//

    //Desconfigura todos los valores de sesión
    $_SESSION = array();
    //Obtén parámetros de sesión
    $params = session_get_cookie_params();
    //Borra la cookie actual
    setcookie(session_name(), '', time() - 42000, $params["path"], $params["domain"], $params["secure"], $params["httponly"]);
    //Destruye sesión
    session_destroy();

